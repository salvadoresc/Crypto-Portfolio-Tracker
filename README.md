# üöÄ Crypto Portfolio Tracker - WordPress Plugin

Un plugin completo de WordPress para crear un tracker de portfolio de criptomonedas con soporte multi-usuario, dise√±ado para uso p√∫blico.

![Version](https://img.shields.io/badge/version-1.0.0-blue)
![WordPress](https://img.shields.io/badge/WordPress-5.0%2B-blue)
![PHP](https://img.shields.io/badge/PHP-7.4%2B-purple)
![License](https://img.shields.io/badge/license-GPL%20v2-green)

## ‚ú® Caracter√≠sticas Principales

### üéØ Para Usuarios
- **Portfolio Personalizado**: Cada usuario registrado tiene su propio portfolio privado
- **An√°lisis en Tiempo Real**: Precios actualizados desde CoinGecko API con cache inteligente
- **C√°lculo Autom√°tico de P&L**: ROI y ganancias/p√©rdidas calculadas autom√°ticamente
- **Gesti√≥n de Transacciones**: A√±adir compras/ventas con historial completo
- **Dashbaord Moderno**: Interfaz React con glassmorphism y animaciones
- **Gr√°ficos Interactivos**: Visualizaciones con Recharts para an√°lisis
- **Exportaci√≥n de Datos**: Descarga tu portfolio en JSON/CSV
- **Watchlist**: Monitorea cryptos sin invertir (pr√≥ximamente)

### üîß Para Administradores
- **Setup Wizard**: Configuraci√≥n autom√°tica paso a paso
- **Dashboard de Administraci√≥n**: Estad√≠sticas y m√©tricas del sitio (respetando privacidad)
- **Gesti√≥n Multi-Usuario**: Soporte para registro p√∫blico
- **Control de Cache**: Optimizaci√≥n de rendimiento de API
- **Estad√≠sticas Agregadas**: Usuarios activos, transacciones, cryptos populares
- **Exportaci√≥n de Stats**: Backup de estad√≠sticas generales
- **Sistema de Permisos**: Control granular de funcionalidades

## üóÇÔ∏è Arquitectura T√©cnica

### Frontend
- **React 18** con Hooks modernos
- **Tailwind CSS** personalizado para styling
- **Recharts** para gr√°ficos y visualizaciones
- **WordPress REST API** para comunicaci√≥n backend
- **Cache inteligente** para optimizaci√≥n

### Backend
- **WordPress REST API** personalizada con endpoints seguros
- **Tablas MySQL** optimizadas con √≠ndices
- **CoinGecko API** para precios en tiempo real
- **Sistema de Cache** transient de WordPress (5 min por defecto)
- **Hooks y Filters** de WordPress para extensibilidad

### Base de Datos
- **cpt_portfolio**: Holdings de usuarios con precios actuales
- **cpt_transactions**: Historial completo de transacciones
- **cpt_watchlist**: Lista de seguimiento de cryptos

## üì¶ Instalaci√≥n

### Instalaci√≥n Manual

1. **Descarga el Plugin**
   ```bash
   git clone https://github.com/tu-usuario/crypto-portfolio-tracker.git
   cd crypto-portfolio-tracker
   ```

2. **Sube a WordPress**
   - Copia la carpeta completa a `/wp-content/plugins/`
   - O sube el archivo ZIP desde WordPress Admin ‚Üí Plugins ‚Üí A√±adir nuevo

3. **Activa el Plugin**
   - Ve a WordPress Admin ‚Üí Plugins
   - Busca "Crypto Portfolio Tracker"
   - Haz clic en "Activar"

4. **Configuraci√≥n Autom√°tica**
   - Ve a **Crypto Portfolio** en el men√∫ de administraci√≥n
   - El Setup Wizard se ejecutar√° autom√°ticamente
   - ¬°Listo! üéâ

### Verificaci√≥n de Instalaci√≥n

El plugin incluye un sistema de verificaci√≥n que comprueba:
- ‚úÖ Creaci√≥n autom√°tica de tablas de BD
- ‚úÖ Configuraci√≥n de p√°gina con shortcode
- ‚úÖ Verificaci√≥n de dependencias React
- ‚úÖ Conexi√≥n a CoinGecko API
- ‚úÖ Configuraci√≥n de cache

## ‚öôÔ∏è Configuraci√≥n

### Setup Wizard (Recomendado)

El plugin incluye un asistente de configuraci√≥n que se ejecuta autom√°ticamente:

1. **Configuraci√≥n de P√°gina**: Crea autom√°ticamente la p√°gina del dashboard
2. **Verificaci√≥n de Permisos**: Comprueba registro de usuarios
3. **Configuraci√≥n de API**: Configura CoinGecko API
4. **Tablas de BD**: Crea las tablas necesarias
5. **Verificaci√≥n de Frontend**: Comprueba dependencias React/Recharts

### Configuraci√≥n Manual

#### 1. CoinGecko API (Opcional)
```php
// Para mayor l√≠mite de requests (recomendado para sitios grandes)
// En Crypto Portfolio ‚Üí Configuraci√≥n
$settings['coingecko_api_key'] = 'tu_api_key_aqui';
$settings['cache_duration'] = 300; // 5 minutos
```

#### 2. Habilitar Registro P√∫blico
```php
// En wp-admin ‚Üí Configuraci√≥n ‚Üí General
update_option('users_can_register', 1);
```

#### 3. Configurar P√°gina del Dashboard
El plugin crea autom√°ticamente una p√°gina con el shortcode `[crypto_dashboard]`, pero puedes usar el shortcode en cualquier p√°gina.

## üé® Uso del Plugin

### Shortcodes Disponibles

#### Dashboard Principal
```php
[crypto_dashboard]
// Muestra el dashboard completo para usuarios logueados
```

#### Dashboard P√∫blico (Pr√≥ximamente)
```php
[crypto_dashboard public="true"]
// Permite ver datos sin registro
```

### Hooks Disponibles

#### Actions
```php
// Despu√©s de a√±adir transacci√≥n
do_action('cpt_transaction_added', $user_id, $transaction_data);

// Despu√©s de actualizar portfolio
do_action('cpt_portfolio_updated', $user_id, $portfolio_data);

// Despu√©s de login exitoso
do_action('cpt_user_dashboard_accessed', $user_id);
```

#### Filters
```php
// Modificar configuraciones por defecto
$settings = apply_filters('cpt_default_settings', $settings);

// Personalizar datos del portfolio
$portfolio = apply_filters('cpt_portfolio_data', $portfolio, $user_id);

// Modificar precios mostrados
$prices = apply_filters('cpt_coin_prices', $prices, $coin_ids);
```

## üõ†Ô∏è API Endpoints

### Portfolio
```javascript
// Obtener portfolio del usuario
GET /wp-json/crypto-portfolio/v1/portfolio

// Actualizar item del portfolio
POST /wp-json/crypto-portfolio/v1/portfolio

// Eliminar item del portfolio
DELETE /wp-json/crypto-portfolio/v1/portfolio/{coin_id}

// Limpiar duplicados
POST /wp-json/crypto-portfolio/v1/portfolio/clean
```

### Transacciones
```javascript
// Obtener transacciones
GET /wp-json/crypto-portfolio/v1/transactions

// A√±adir nueva transacci√≥n
POST /wp-json/crypto-portfolio/v1/transactions
{
  "coin_id": "bitcoin",
  "coin_symbol": "BTC", 
  "coin_name": "Bitcoin",
  "type": "buy",
  "amount": 100.00,     // Monto total invertido
  "price": 45000.00,    // Precio por unidad
  "quantity": 0.00222,  // Cantidad exacta recibida
  "date": "2024-01-15",
  "exchange": "Binance",
  "notes": "Compra mensual"
}

// Actualizar transacci√≥n
PUT /wp-json/crypto-portfolio/v1/transactions/{id}

// Eliminar transacci√≥n
DELETE /wp-json/crypto-portfolio/v1/transactions/{id}
```

### Market Data
```javascript
// Buscar cryptos
GET /wp-json/crypto-portfolio/v1/market/search?q=bitcoin

// Obtener precios actuales
GET /wp-json/crypto-portfolio/v1/market/prices?ids=bitcoin,ethereum

// Cryptos trending
GET /wp-json/crypto-portfolio/v1/market/trending
```

### Watchlist
```javascript
// Obtener watchlist
GET /wp-json/crypto-portfolio/v1/watchlist

// A√±adir a watchlist
POST /wp-json/crypto-portfolio/v1/watchlist

// Remover de watchlist
DELETE /wp-json/crypto-portfolio/v1/watchlist/{coin_id}
```

## üéØ Caracter√≠sticas T√©cnicas

### Seguridad
- **Nonces de WordPress** para todas las peticiones AJAX
- **Sanitizaci√≥n** de todos los inputs
- **Validaci√≥n** de permisos por usuario
- **Escape** de outputs para prevenir XSS
- **Privacidad**: El admin NO puede ver montos individuales

### Performance
- **Cache inteligente** de precios (5 min configurable)
- **Lazy loading** de componentes React
- **Optimizaci√≥n de queries** con √≠ndices de BD
- **Chunking** de peticiones a APIs externas
- **Transients** de WordPress para cache

### Compatibilidad
- **WordPress 5.0+** con Gutenberg
- **PHP 7.4+** con type hints
- **React 18** con concurrent features
- **Recharts 2.x** para gr√°ficos
- **Responsive design** para m√≥viles

## üîß Desarrollo y Personalizaci√≥n

### Estructura de Archivos
```
crypto-portfolio-tracker/
‚îú‚îÄ‚îÄ crypto-portfolio-tracker.php    # Archivo principal
‚îú‚îÄ‚îÄ includes/
‚îÇ   ‚îú‚îÄ‚îÄ class-database.php          # Manejo de BD
‚îÇ   ‚îú‚îÄ‚îÄ class-api-handler.php       # REST API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ class-user-portfolio.php    # L√≥gica de portfolio
‚îÇ   ‚îî‚îÄ‚îÄ class-coingecko-api.php     # Integraci√≥n CoinGecko
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard-admin.php         # Dashboard de admin
‚îÇ   ‚îî‚îÄ‚îÄ settings.php                # P√°gina de configuraci√≥n
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ js/dashboard.js             # React dashboard
‚îÇ   ‚îî‚îÄ‚îÄ css/dashboard.css           # Estilos personalizados
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ INSTALL.md
```

### Personalizar Estilos
Edita `assets/css/dashboard.css` para cambiar:
- Colores del tema (glassmorphism)
- Tama√±os de fuente
- Espaciados y animaciones
- Efectos visuales

### A√±adir Nuevas Funcionalidades
1. Crea hooks personalizados en el archivo principal
2. A√±ade endpoints en `includes/class-api-handler.php`
3. Modifica el componente React en `assets/js/dashboard.js`
4. Actualiza la clase Database si necesitas nuevas tablas

## üìä Dashboard Features

### Estad√≠sticas en Tiempo Real
- **Inversi√≥n Total**: Suma de todos los montos invertidos
- **Valor Actual**: Valor del portfolio con precios actuales
- **P&L Total**: Ganancias/p√©rdidas en USD y porcentaje
- **ROI**: Return on Investment calculado autom√°ticamente

### Gr√°ficos Interactivos
- **Evoluci√≥n de Inversiones**: Timeline de inversiones acumulativas
- **Distribuci√≥n del Portfolio**: Pie chart con porcentajes
- **Performance por Crypto**: Bar chart con ROI por moneda

### Gesti√≥n de Transacciones
- **Formulario Inteligente**: Autocompletado con CoinGecko
- **Edici√≥n/Eliminaci√≥n**: Gesti√≥n completa del historial
- **Validaci√≥n**: Verificaci√≥n de datos en tiempo real
- **Rec√°lculo Autom√°tico**: Portfolio se actualiza en cada cambio

## üõ°Ô∏è Privacidad y Seguridad

### Compromiso de Privacidad
- Los administradores **NO pueden ver** montos individuales de usuarios
- Dashboard de admin muestra solo **estad√≠sticas agregadas**
- **Datos sensibles protegidos** a nivel de c√≥digo
- **Cumplimiento GDPR** con exportaci√≥n de datos personales

### Medidas de Seguridad
- **Validaci√≥n estricta** de todos los inputs
- **Sanitizaci√≥n** antes de guardado en BD
- **Nonces** para prevenir CSRF
- **Permisos granulares** por funcionalidad
- **Rate limiting** en API externa

## üöÄ Roadmap

### v1.1 (Pr√≥ximamente)
- [ ] Watchlist completa con alertas
- [ ] Importaci√≥n CSV de transacciones
- [ ] M√°s exchanges soportados
- [ ] Notificaciones push

### v1.2 (Futuro)
- [ ] Portfolio sharing p√∫blico
- [ ] An√°lisis t√©cnico b√°sico
- [ ] Integraci√≥n con m√°s APIs
- [ ] Dashboard para m√≥vil nativo
- [ ] Sistema de traducciones i18n

## üÜò Soporte y Troubleshooting

### Problemas Comunes

1. **Dashboard no se muestra**
   - Verifica que la p√°gina tenga el shortcode `[crypto_dashboard]`
   - Aseg√∫rate de que el usuario est√© logueado
   - Revisa la consola del navegador para errores JS

2. **Error "Class not found"**
   - Verifica que todos los archivos est√©n en las carpetas correctas
   - Desactiva y reactiva el plugin

3. **Precios no se actualizan**
   - Ve a Crypto Portfolio ‚Üí Configuraci√≥n ‚Üí Limpiar Cache
   - Verifica la conexi√≥n a CoinGecko API

4. **Gr√°ficos no aparecen**
   - Recarga la p√°gina (Recharts se carga as√≠ncrono)
   - Verifica que hay datos en el portfolio

### Debug Mode
```php
// A√±adir a wp-config.php para debug
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
```

### Logs del Plugin
El plugin registra informaci√≥n en el log de WordPress:
- Errores de API
- Creaci√≥n/actualizaci√≥n de transacciones
- C√°lculos de portfolio

## üìû Soporte

Si tienes problemas:
1. **Revisa los logs** de error de WordPress
2. **Activa WP_DEBUG** en wp-config.php
3. **Verifica** que todos los archivos est√©n en su lugar
4. **Comprueba** que PHP >= 7.4 y WordPress >= 5.0
5. **Prueba** desactivar otros plugins para detectar conflictos

Para reportar bugs o solicitar features, abre un issue en el repositorio de GitHub.

## üìú Licencia

Este plugin est√° licenciado bajo GPL v2 o posterior. Es software libre: puedes redistribuirlo y/o modificarlo bajo los t√©rminos de la Licencia P√∫blica General GNU.

---

**Desarrollado con ‚ù§Ô∏è para la comunidad crypto de WordPress**

¬°Gracias por usar Crypto Portfolio Tracker! ‚≠êÔ∏è